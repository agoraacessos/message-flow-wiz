# ğŸ¯ FLUXO VISUAL - Sistema de RecuperaÃ§Ã£o de Conversas

## ğŸ“± **CenÃ¡rio: Cliente digita "teste123"**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WHATSAPP - CONVERSATION                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Cliente: teste123                                              â”‚
â”‚  â° 10:00:00                                                    â”‚
â”‚                                                                 â”‚
â”‚  ğŸ¤– Sistema: OlÃ¡! Vi que vocÃª tem interesse. Como posso ajudar? â”‚
â”‚  â° 10:00:01 (ENVIADO IMEDIATAMENTE)                           â”‚
â”‚                                                                 â”‚
â”‚  â³ Aguardando resposta... (30 minutos)                        â”‚
â”‚                                                                 â”‚
â”‚  ğŸ¤– Sistema: Oi! VocÃª ainda tem interesse? Posso esclarecer     â”‚
â”‚              suas dÃºvidas.                                     â”‚
â”‚  â° 10:30:01 (ENVIADO APÃ“S 30 MIN)                            â”‚
â”‚                                                                 â”‚
â”‚  â³ Aguardando resposta... (30 minutos)                        â”‚
â”‚                                                                 â”‚
â”‚  ğŸ¤– Sistema: Ãšltima tentativa! Temos uma oferta especial hoje. â”‚
â”‚              Quer saber mais?                                  â”‚
â”‚  â° 11:00:01 (ENVIADO APÃ“S 60 MIN TOTAL)                      â”‚
â”‚                                                                 â”‚
â”‚  â³ Aguardando resposta... (30 minutos)                        â”‚
â”‚                                                                 â”‚
â”‚  âŒ FLUXO FINALIZADO - MÃ¡ximo de tentativas atingido           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ **CenÃ¡rio: Cliente responde apÃ³s a primeira mensagem**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WHATSAPP - CONVERSATION                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Cliente: teste123                                              â”‚
â”‚  â° 10:00:00                                                    â”‚
â”‚                                                                 â”‚
â”‚  ğŸ¤– Sistema: OlÃ¡! Vi que vocÃª tem interesse. Como posso ajudar?â”‚
â”‚  â° 10:00:01 (ENVIADO IMEDIATAMENTE)                           â”‚
â”‚                                                                 â”‚
â”‚  Cliente: Sim, quero saber mais sobre o produto!              â”‚
â”‚  â° 10:05:00 (RESPOSTA RECEBIDA)                               â”‚
â”‚                                                                 â”‚
â”‚  âœ… FLUXO FINALIZADO - Cliente respondeu!                      â”‚
â”‚     (NÃ£o envia mais mensagens automÃ¡ticas)                     â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âš™ï¸ **ConfiguraÃ§Ã£o no Sistema**

### **1. Criar Regra**
```
Nome: Cliente Interessado
Texto: teste123
Tipo: ContÃ©m
Timeout: 30 minutos
Tentativas: 3
```

### **2. Configurar SequÃªncia**
```
Mensagem 1: "OlÃ¡! Vi que vocÃª tem interesse. Como posso ajudar?"
Delay: 0 minutos (imediata)

Mensagem 2: "Oi! VocÃª ainda tem interesse? Posso esclarecer suas dÃºvidas."
Delay: 30 minutos

Mensagem 3: "Ãšltima tentativa! Temos uma oferta especial hoje. Quer saber mais?"
Delay: 30 minutos
```

## ğŸ“Š **Estados do Sistema**

### **Estado: waiting_response**
```
Cliente digitou "teste123"
â†“
Sistema enviou primeira mensagem
â†“
Aguardando resposta do cliente...
```

### **Estado: sending_message**
```
Timeout atingido (30 min)
â†“
Sistema preparando prÃ³xima mensagem
â†“
Enviando mensagem...
```

### **Estado: completed**
```
Cliente respondeu!
â†“
Fluxo finalizado com sucesso
â†“
NÃ£o envia mais mensagens automÃ¡ticas
```

### **Estado: failed**
```
Erro ao enviar mensagem
â†“
Fluxo marcado como falha
â†“
Log de erro criado
```

## ğŸ¯ **Casos de Uso Reais**

### **Caso 1: Cliente Interessado**
```
Trigger: "interessado", "quero saber", "me interessa"
Fluxo:
1. "OlÃ¡! Vi que vocÃª tem interesse. Como posso ajudar?" (0min)
2. "Oi! VocÃª ainda tem interesse? Posso esclarecer suas dÃºvidas." (30min)
3. "Ãšltima tentativa! Temos uma oferta especial hoje. Quer saber mais?" (60min)
```

### **Caso 2: Cliente Pergunta PreÃ§o**
```
Trigger: "quanto custa", "qual o preÃ§o", "valor"
Fluxo:
1. "O preÃ§o Ã© R$ 299,00. Posso explicar o que estÃ¡ incluÃ­do!" (0min)
2. "Quer saber sobre nossos benefÃ­cios exclusivos?" (15min)
3. "Temos um desconto especial hoje. Quer aproveitar?" (60min)
```

### **Caso 3: Cliente Indeciso**
```
Trigger: "nÃ£o sei", "talvez", "pensando"
Fluxo:
1. "Entendo sua indecisÃ£o. Posso esclarecer suas dÃºvidas!" (0min)
2. "Veja os benefÃ­cios que nossos clientes tÃªm relatado..." (45min)
3. "Que tal uma conversa rÃ¡pida para esclarecer tudo?" (2h)
```

## ğŸ”§ **ConfiguraÃ§Ãµes AvanÃ§adas**

### **Timeouts Personalizados**
```
Mensagem 1: 0 minutos (imediata)
Mensagem 2: 15 minutos (urgente)
Mensagem 3: 60 minutos (paciente)
Mensagem 4: 120 minutos (Ãºltima chance)
```

### **Webhooks EspecÃ­ficos**
```
Mensagem 1: https://webhook1.com/send
Mensagem 2: https://webhook2.com/send
Mensagem 3: https://webhook3.com/send
```

### **Tipos de AtivaÃ§Ã£o**
```
ContÃ©m: "teste123" (qualquer lugar)
Exato: "teste123" (exatamente isso)
ComeÃ§a com: "teste" (mensagem comeÃ§a com "teste")
Termina com: "123" (mensagem termina com "123")
Regex: ^teste\d+$ (padrÃ£o personalizado)
```

## ğŸ“ˆ **Monitoramento e Logs**

### **Log de AtivaÃ§Ã£o**
```
[10:00:00] rule_triggered: Cliente "5511999999999" digitou "teste123"
[10:00:01] message_sent: Mensagem 1 enviada com sucesso
[10:30:01] timeout_reached: Cliente nÃ£o respondeu em 30min
[10:30:02] message_sent: Mensagem 2 enviada com sucesso
[11:00:01] timeout_reached: Cliente nÃ£o respondeu em 30min
[11:00:02] message_sent: Mensagem 3 enviada com sucesso
[11:30:01] flow_completed: Fluxo finalizado - mÃ¡ximo de tentativas
```

### **Log de Sucesso**
```
[10:00:00] rule_triggered: Cliente "5511999999999" digitou "teste123"
[10:00:01] message_sent: Mensagem 1 enviada com sucesso
[10:05:00] response_received: Cliente respondeu "Sim, quero saber mais!"
[10:05:01] flow_completed: Fluxo finalizado - cliente respondeu
```

## ğŸš€ **PrÃ³ximos Passos**

1. **Execute o script SQL** no Supabase
2. **Configure suas regras** na interface
3. **Teste com mensagens** reais
4. **Monitore os logs** para ajustar
5. **Otimize os timeouts** baseado nos resultados

---

**ğŸ’¡ Dica:** Comece com regras simples e timeouts curtos para testar. Depois ajuste baseado no comportamento real dos seus clientes!
